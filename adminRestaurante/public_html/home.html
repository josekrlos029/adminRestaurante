<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="css/restaurantes.min.css" />
        <link rel="stylesheet" href="css/jquery.mobile.icons.min.css" />
        <link rel="stylesheet" href="css/jquery.mobile.structure-1.4.2.min.css" />
        <link rel="stylesheet" href="css/style.css" />
        <script src="js/jquery-1.11.1.min.js"></script>
        <script src="js/jquery.mobile-1.4.2.min.js"></script>
        <script src="js/app.js"></script>
        <script src="phonegap.js" type="text/javascript"></script>
        <script type="text/javascript" charset="utf-8" src="PushNotification.js"></script>   
        <script>
            document.addEventListener("deviceready", onDeviceReady, false);

            function onDeviceReady() {
                update();
                cargarPedidios();
                var pushNotification = window.plugins.pushNotification;

                if (device.platform == 'android' || device.platform == 'Android')
                {
                    //PARA ANDROID
                    pushNotification.register(
                            successHandler,
                            errorHandler, {
                                "senderID": "616270198580", //ID del proyecto  (Debes crear un proyecto en google developers -> https://console.developers.google.com/project )
                                "ecb": "onNotificationGCM"  //Metodo cuando llega una notificación
                            });
                }
                else
                {
                    //Para IOS
                    pushNotification.register(
                            tokenHandler,
                            errorHandler, {
                                "badge": "true",
                                "sound": "true",
                                "alert": "true",
                                "ecb": "onNotificationAPN"
                            });
                }

            }


            function successHandler(result) {
                //alert('result = ' + result);
            }

            function errorHandler(error) {
                alert('error = ' + error);
            }

            function onNotificationGCM(e) {

                switch (e.event)
                {
                    case 'registered':
                        if (e.regid.length > 0)
                        {
                            //localStorage.setItem("regId", e.regid);
                        }
                        break;

                    case 'message':
                        // if this flag is set, this notification happened while we were in the foreground.
                        // you might want to play a sound to get the user's attention, throw up a dialog, etc.
                        if (e.foreground)
                        {

                            //$("#app-status-ul").append('<li>--INLINE NOTIFICATION--' + '</li>');

                            // if the notification contains a soundname, play it.

                        }
                        else
                        {  // otherwise we were launched because the user touched a notification in the notification tray.
                            if (e.coldstart)
                            {
                                //$("#app-status-ul").append('<li>--COLDSTART NOTIFICATION--' + '</li>');

                            }
                            else
                            {
                                //$("#app-status-ul").append('<li>--BACKGROUND NOTIFICATION--' + '</li>');
                            }
                        }
                        //alert(e.payload.message + ",  " + e.payload.otro ); 
                        //$("#app-status-ul").append('<li>MESSAGE -> MSG: ' + e.payload.message + '</li>');
                        //$("#app-status-ul").append('<li>MESSAGE -> MSGCNT: ' + e.payload.msgcnt + '</li>');
                        break;

                    case 'error':
                        alert('Error: ' + e.msg);
                        break;

                    default:
                        //$("#app-status-ul").append('<li>EVENT -> Unknown, an event was received and we do not know what it is</li>');
                        break;
                }
            }

            function onNotificationAPN(event) {
                if (event.alert)
                {
                    navigator.notification.alert(event.alert);
                }

                if (event.sound)
                {
                    var snd = new Media(event.sound);
                    snd.play();
                }

                if (event.badge)
                {
                    pushNotification.setApplicationIconBadgeNumber(successHandler, errorHandler, event.badge);
                }
            }
        </script>
    </head>
    <body>
        <div data-role="page" id="pagina">

            <div data-role="header" data-position="fixed" data-fullscreen="false">
                <a href="#menu" style="border: none; background-color: #cc0000; box-shadow: none;" class="ui-nodisc-icon ui-btn ui-shadow ui-corner-all ui-icon-bars ui-btn-icon-notext ui-btn-a ui-btn-inline">Menù</a>
                <h3>Tu Domicilio</h3>
                <a href="#" onclick="cargarPedidios()" style="border: none; background-color: #cc0000;  box-shadow: none;" class="ui-nodisc-icon ui-btn ui-shadow ui-corner-all ui-icon-refresh ui-btn-icon-notext ui-btn-a ui-btn-inline">Buscar</a>
            </div>
            <div data-role="panel" data-display="overlay" id="menu">
                <p>Menù !</p>
            </div><!-- /panel -->
            <div role="main" class="ui-content">                
                <div class="ui-body ui-body-a ui-corner-all">

                    <center><h1>Tus Domicilios</h1></center>
                    <div data-role="tabs" id="tabs">
                        <div data-role="navbar">
                            <ul>
                                <li><a style="font-size: 11px" href="#one" data-ajax="false">Pendientes</a></li>
                                <li><a style="font-size: 11px" href="#two" data-ajax="false">Aceptados</a></li>
                                <li><a style="font-size: 11px" href="#three" data-ajax="false">Entregados</a></li>
                            </ul>
                        </div>
                        <div id="contenido"></div>
                    </div>
                    <div data-role="popup" id="popupAceptar" data-dismissible="false" data-overlay-theme="b" data-theme="b" class="ui-corner-all">

                        <div style="padding:10px 20px;">
                            <a href="#" data-rel="back" id="close1" class="ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a>
                            <h3>¿Estas seguro de aceptar la solicitud?</h3>
                            <input type="hidden" value="" id="idAceptar">
                            <button class="ui-btn ui-corner-all ui-shadow ui-btn-b ui-btn-icon-right ui-icon-check" onclick="aceptar()">Aceptar</button>
                            <button data-rel="back" class="ui-btn ui-corner-all ui-shadow ui-btn-b ui-btn-icon-right ui-icon-check" >Cancelar</button>
                        </div>

                    </div>

                    <div data-role="popup" id="popupListo" data-dismissible="false" data-overlay-theme="b" data-theme="b" class="ui-corner-all">

                        <div style="padding:10px 20px;">
                            <a href="#" data-rel="back" id="close4" class="ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a>
                            <h3>¿Estas seguro de aceptar la solicitud?</h3>
                            <input type="hidden" value="" id="idListo">
                            <button class="ui-btn ui-corner-all ui-shadow ui-btn-b ui-btn-icon-right ui-icon-check" onclick="listo()">Aceptar</button>
                            <button data-rel="back" class="ui-btn ui-corner-all ui-shadow ui-btn-b ui-btn-icon-right ui-icon-check" >Cancelar</button>
                        </div>

                    </div>

                    <div data-role="popup" id="popupRechazar" data-dismissible="false" data-overlay-theme="b" data-theme="b" class="ui-corner-all">

                        <div style="padding:10px 20px;">
                            <a href="#" data-rel="back" id="close2" class="ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a>
                            <h3>¿Estas seguro de Rechazar la solicitud?</h3>
                            <input type="hidden" value="" id="idRechazar">
                            <button class="ui-btn ui-corner-all ui-shadow ui-btn-b ui-btn-icon-right ui-icon-check" onclick="rechazar()">Aceptar</button>
                            <button data-rel="back" class="ui-btn ui-corner-all ui-shadow ui-btn-b ui-btn-icon-right ui-icon-check" >Cancelar</button>
                        </div>

                    </div>
                    <div data-role="popup" id="popupCancelar" data-dismissible="false" data-overlay-theme="b" data-theme="b" class="ui-corner-all">

                        <div style="padding:10px 20px;">
                            <a href="#" data-rel="back" id="close3" class="ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a>
                            <h3>¿Estas seguro de Cancelar la solicitud?</h3>
                            <input type="hidden" value="" id="idCancelar">
                            <button class="ui-btn ui-corner-all ui-shadow ui-btn-b ui-btn-icon-right ui-icon-check" onclick="cancelar()">Aceptar</button>
                            <button data-rel="back" class="ui-btn ui-corner-all ui-shadow ui-btn-b ui-btn-icon-right ui-icon-check" >Cancelar</button>
                        </div>

                    </div>
                </div>

            </div>

        </div>
    </body>
</html>
